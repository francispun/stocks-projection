<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSTR BTC Leverage Simulator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #000000;
            color: #f7931a;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            text-align: center;
            color: #f7931a;
            text-shadow: 0 0 10px #f7931a;
            margin-bottom: 20px;
            font-size: 2.5em;
        }
        .container {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(247, 147, 26, 0.3);
            width: 100%;
            max-width: 900px;
        }
        .controls {
            margin-bottom: 30px;
        }
        .control-group {
            margin-bottom: 25px;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 10px;
            border: 1px solid #f7931a;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #f7931a;
            font-size: 1.1em;
        }
        input[type="range"] {
            width: 100%;
            margin-bottom: 10px;
            accent-color: #f7931a;
        }
        .value-display {
            font-size: 1.2em;
            color: #ffffff;
            font-weight: bold;
            text-align: center;
            padding: 5px;
            background: #333333;
            border-radius: 5px;
            display: inline-block;
        }
        .result {
            padding: 20px;
            border-radius: 10px;
            background: #2a2a2a;
            border: 1px solid #f7931a;
            overflow-x: auto;
        }
        table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            margin-top: 15px;
            background: #1a1a1a;
            table-layout: fixed;
        }
        th, td {
            border: 2px solid #f7931a;
            padding: 12px;
            text-align: center;
            color: #e68a00;
            font-weight: bold;
            font-size: 1.0em;
        }
        th {
            background-color: #333333;
            font-size: 1.1em;
        }
        .orange-value {
            background-color: #f7931a;
            color: #000000;
            font-weight: bold;
        }
        .yellow-value {
            background-color: #ffff00;
            color: #000000;
            font-weight: bold;
        }
        caption {
            font-weight: bold;
            margin-bottom: 10px;
            color: #f7931a;
            font-size: 1.2em;
        }
        p {
            color: #ffffff;
            font-size: 0.9em;
            margin-top: 10px;
        }
        .instruction {
            font-style: italic;
            color: #cccccc;
            margin-top: 5px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MSTR BTC Leverage Simulator</h1>
        <div class="controls">
            <div class="control-group">
                <label for="btcArr">BTC ARR (%): 
                    <span class="instruction">Slide to set the base annualized Bitcoin return (0-50%). Adjusts the growth potential across all leverage levels.</span>
                </label>
                <input type="range" id="btcArr" min="0" max="50" value="30" oninput="updateTable()">
                <div class="value-display" id="btcArrValue">30%</div>
            </div>
            <div class="control-group">
                <label for="leverage">Leverage (%): 
                    <span class="instruction">Adjust the base leverage (0-50%) to see its impact on the BTC Factor across different ARR levels.</span>
                </label>
                <input type="range" id="leverage" min="0" max="50" value="30" oninput="updateTable()">
                <div class="value-display" id="leverageValue">30%</div>
            </div>
            <div class="control-group">
                <label for="dividendRate">Dividend Rate (%): 
                    <span class="instruction">Set the financing cost (0-15%). Higher rates reduce the BTC Factor as they increase the cost of leverage (e.g., 8% from preferred stock).</span>
                </label>
                <input type="range" id="dividendRate" min="0" max="15" value="8" step="0.1" oninput="updateTable()">
                <div class="value-display" id="dividendRateValue">8%</div>
            </div>
            <div class="control-group">
                <label for="duration">Duration (Years): 
                    <span class="instruction">Choose the projection period (1-20 years). Longer durations increase the BTC Factor due to compounding (e.g., 10 years is default).</span>
                </label>
                <input type="range" id="duration" min="1" max="20" value="10" oninput="updateTable()">
                <div class="value-display" id="durationValue">10</div>
            </div>
        </div>
        <div class="result">
            <table id="btcTable">
                <caption>BTC Factor (Ratio of Ending BPS to Starting BPS)</caption>
                <thead>
                    <tr>
                        <th>BTC ARR %</th>
                        <th>0%</th>
                        <th>10%</th>
                        <th>20%</th>
                        <th>30%</th>
                        <th>40%</th>
                        <th>50%</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><th>0%</th><td>1.0x</td><td>1.0x</td><td>1.1x</td><td>1.1x</td><td>1.2x</td><td>1.3x</td></tr>
                    <tr><th>10%</th><td>1.0x</td><td>1.1x</td><td>1.3x</td><td>1.5x</td><td>1.8x</td><td>2.2x</td></tr>
                    <tr><th>20%</th><td>1.0x</td><td>1.2x</td><td>1.6x</td><td>2.1x</td><td>2.9x</td><td>4.3x</td></tr>
                    <tr><th>30%</th><td>1.0x</td><td>1.3x</td><td>1.9x</td><td>2.8x</td><td>4.4x</td><td>7.8x</td></tr>
                    <tr><th>40%</th><td>1.0x</td><td>1.5x</td><td>2.2x</td><td>3.7x</td><td>6.5x</td><td>13.5x</td></tr>
                    <tr><th>50%</th><td>1.0x</td><td>1.6x</td><td>2.6x</td><td>4.7x</td><td>9.5x</td><td>22.5x</td></tr>
                </tbody>
            </table>
            <p>*Values rounded for display. Adjust sliders to see real-time changes.</p>
        </div>
    </div>

    <script>
        const arrValues = [0, 10, 20, 30, 40, 50];
        const levValues = [0, 10, 20, 30, 40, 50];
        const offset = 0.16;

        function calculateFactor(arr, lev, divRate, duration) {
            const effectiveRate = 1 + (lev / 100) * (arr / 100 + offset - divRate / 100);
            const factor = Math.pow(effectiveRate, duration);
            return (factor < 1 ? 1.0 : factor).toFixed(1);
        }

        function updateTable() {
            console.log("Updating table..."); // Debug log
            const btcArr = parseInt(document.getElementById('btcArr').value);
            const leverage = parseInt(document.getElementById('leverage').value);
            const dividendRate = parseFloat(document.getElementById('dividendRate').value);
            const duration = parseInt(document.getElementById('duration').value);
            
            console.log(`Values: BTC ARR=${btcArr}%, Leverage=${leverage}%, Dividend=${dividendRate}%, Duration=${duration} years`); // Debug log
            
            document.getElementById('btcArrValue').textContent = btcArr + '%';
            document.getElementById('leverageValue').textContent = leverage + '%';
            document.getElementById('dividendRateValue').textContent = dividendRate.toFixed(1) + '%';
            document.getElementById('durationValue').textContent = duration;
            
            const rows = document.querySelectorAll('#btcTable tbody tr');
            const cells = document.querySelectorAll('#btcTable td');
            
            // Remove all highlighting classes
            cells.forEach(cell => {
                cell.classList.remove('orange-value', 'yellow-value');
            });

            // Update table values with slider inputs as base modifiers
            for (let i = 0; i < arrValues.length; i++) {
                for (let j = 0; j < levValues.length; j++) {
                    const cell = rows[i].querySelectorAll('td')[j];
                    if (cell) {
                        // Use arrValues[i] as varying ARR, leverage as base with levValues[j] as offset
                        const adjustedArr = arrValues[i] + (btcArr - 30); // Shift based on btcArr slider (default 30%)
                        const adjustedLev = leverage + (levValues[j] - 30); // Shift based on leverage slider (default 30%)
                        const factor = calculateFactor(adjustedArr, adjustedLev, dividendRate, duration);
                        cell.textContent = factor + 'x';
                    }
                }
            }

            // Apply conditional value highlighting
            cells.forEach(cell => {
                const value = parseFloat(cell.textContent);
                if (value > 4) {
                    cell.classList.add('yellow-value');
                } else if (value > 2) {
                    cell.classList.add('orange-value');
                }
            });
        }

        // Initial update
        updateTable();

        // Ensure event listeners work
        document.getElementById('btcArr').addEventListener('input', updateTable);
        document.getElementById('leverage').addEventListener('input', updateTable);
        document.getElementById('dividendRate').addEventListener('input', updateTable);
        document.getElementById('duration').addEventListener('input', updateTable);
    </script>
</body>
</html>
